# Monoxer App Test Suite

Monoxeråº”ç”¨æµ‹è¯•å¥—ä»¶ï¼ŒåŸºäºATFæ¡†æ¶å®ç°ï¼Œæ”¯æŒå¤šè¯­è¨€æµ‹è¯•ã€‚

## ğŸ“ ç›®å½•ç»“æ„

```
tests/com.monoxer/
â”œâ”€â”€ conftest.py              # Pytesté…ç½®å’Œfixtures
â”œâ”€â”€ test_monoxer_features.py # ä¸»è¦æµ‹è¯•æ–‡ä»¶
â”œâ”€â”€ datas/
â”‚   â””â”€â”€ test_data.py         # å¤šè¯­è¨€æµ‹è¯•æ•°æ®å®šä¹‰
â”œâ”€â”€ pages/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ main_page.py         # ä¸»é¡µé¢å¯¹è±¡
â”‚   â”œâ”€â”€ search_page.py       # æœç´¢é¡µé¢å¯¹è±¡
â”‚   â””â”€â”€ library_page.py      # Libraryé¡µé¢å¯¹è±¡
â”œâ”€â”€ screenshots/             # æˆªå›¾ç›®å½•
â”‚   â”œâ”€â”€ base/               # åŸºå‡†æˆªå›¾
â”‚   â””â”€â”€ cur/                # å½“å‰æµ‹è¯•æˆªå›¾
â””â”€â”€ README.md               # æœ¬æ–‡æ¡£
```

## ğŸŒ å¤šè¯­è¨€æ”¯æŒ

### æ”¯æŒçš„è¯­è¨€
- **è‹±æ–‡ (en)**: é»˜è®¤è¯­è¨€ï¼Œä½¿ç”¨ `emulator-5554` (Android 13)
- **æ—¥æ–‡ (ja)**: ä½¿ç”¨ `emulator-5556` (Android 14)

### è¯­è¨€ç›¸å…³é…ç½®
- **Appiumé…ç½®**: ä¸åŒè¯­è¨€å¯¹åº”ä¸åŒçš„æ¨¡æ‹Ÿå™¨å’Œå¹³å°ç‰ˆæœ¬
- **å®šä½å™¨**: è¯­è¨€ç›¸å…³çš„UIæ–‡æœ¬ä½¿ç”¨å¯¹åº”è¯­è¨€çš„å®šä½å™¨
- **æµ‹è¯•æ•°æ®**: æœç´¢å…³é”®è¯ç­‰æµ‹è¯•æ•°æ®æ”¯æŒå¤šè¯­è¨€

### æ¶æ„è®¾è®¡
- **åŸºç±»**: `BaseMonoxerTestData` åŒ…å«å…¬å…±å…ƒç´ å’Œé…ç½®
- **è¯­è¨€ç±»**: ç»§æ‰¿åŸºç±»ï¼Œæä¾›è¯­è¨€ç‰¹å®šçš„å®šä½å™¨å’Œé…ç½®
- **é¡µé¢å¯¹è±¡**: æ”¯æŒä¼ å…¥è¯­è¨€ç‰¹å®šçš„æµ‹è¯•æ•°æ®ç±»

## ğŸš€ åŠŸèƒ½ç‰¹æ€§

### âœ… å·²å®ç°åŠŸèƒ½

1. **é‚€è¯·ç åŠŸèƒ½æµ‹è¯•** (`test_invitation_code_feature`)
   - æ‰“å¼€ä¾§è¾¹æ 
   - ç‚¹å‡»"Enter invitation code" / "æ‹›å¾…ã‚³ãƒ¼ãƒ‰ã‚’å…¥åŠ›"
   - éªŒè¯é¡µé¢è·³è½¬
   - è¿”å›ä¸»é¡µé¢

2. **åŒæ­¥åŠŸèƒ½æµ‹è¯•** (`test_sync_feature`)
   - æ‰“å¼€ä¾§è¾¹æ 
   - ç‚¹å‡»"Sync" / "åŒæœŸ" æŒ‰é’®
   - ç­‰å¾…åŒæ­¥å®Œæˆ
   - æ£€æŸ¥"Synced" toastæ¶ˆæ¯
   - è¿”å›ä¸»é¡µé¢

3. **æœç´¢åŠŸèƒ½æµ‹è¯•** (`test_search_feature`)
   - ç‚¹å‡»æœç´¢æ ‡ç­¾
   - è¾“å…¥æœç´¢å…³é”®è¯"æ—¥æœ¬ã®ç¥æ—¥"
   - ç‚¹å‡»ç¬¬ä¸€ä¸ªæœç´¢ç»“æœ
   - ç‚¹å‡»contentsæŒ‰é’®æŸ¥çœ‹è¯¦æƒ…
   - å¤šæ¬¡è¿”å›æ“ä½œ
   - è¿”å›ä¸»é¡µé¢

4. **LibraryåŠŸèƒ½æµ‹è¯•** (`test_library_feature`)
   - ç‚¹å‡»Libraryæ ‡ç­¾
   - ç‚¹å‡»"My Books" / "ãƒã‚¤ãƒ–ãƒƒã‚¯" æ ‡ç­¾
   - è‡ªé€‚åº”ç‚¹å‡»auto_testæ ‡é¢˜æˆ–open_deckæŒ‰é’®
   - æ‰“å¼€deckå¹¶è¿”å›
   - æµ‹è¯•STUDYæ¨¡å¼
   - å›ç­”ä¸¤ä¸ªé—®é¢˜ï¼ˆæ”¯æŒé€‰æ‹©é¢˜å’Œå¡«ç©ºé¢˜ï¼‰
   - è¿”å›ä¸»é¡µé¢

### ğŸ“¸ æˆªå›¾ç®¡ç†

- **è‡ªåŠ¨æˆªå›¾**: æ¯ä¸ªæµ‹è¯•æ­¥éª¤è‡ªåŠ¨ä¿å­˜æˆªå›¾
- **ç›®å½•ç»“æ„**: `tests/com.monoxer/screenshots/base/` å’Œ `tests/com.monoxer/screenshots/cur/`
- **æˆªå›¾å¯¹æ¯”**: è‡ªåŠ¨å¯¹æ¯”baseå’Œcurç›®å½•çš„æˆªå›¾
- **åŸºå‡†ç®¡ç†**: æµ‹è¯•æˆåŠŸåè‡ªåŠ¨è®¾ç½®åŸºå‡†æˆªå›¾
- **ä¼šè¯çº§æˆªå›¾**: ä¸€æ¬¡æµ‹è¯•è¿è¡Œä¸­ä¿ç•™æ‰€æœ‰åŠŸèƒ½æµ‹è¯•çš„æˆªå›¾
- **å…¬å…±åˆå§‹åŒ–**: æå–å…¬å…±çš„"initial"æˆªå›¾æ­¥éª¤

## ğŸ› ï¸ è¿è¡Œæµ‹è¯•

### è¿è¡Œå•ä¸ªæµ‹è¯•

```bash
# è‹±æ–‡ç‰ˆæµ‹è¯•
python -m pytest test_monoxer_features.py::TestMonoxerFeatures::test_invitation_code_feature -v --language=en

# æ—¥æ–‡ç‰ˆæµ‹è¯•
python -m pytest test_monoxer_features.py::TestMonoxerFeatures::test_invitation_code_feature -v --language=ja

```

### è¿è¡Œæ‰€æœ‰æµ‹è¯•

```bash
# è‹±æ–‡ç‰ˆæ‰€æœ‰æµ‹è¯•
python -m pytest test_monoxer_features.py -v --language=en

# æ—¥æ–‡ç‰ˆæ‰€æœ‰æµ‹è¯•
python -m pytest test_monoxer_features.py -v --language=ja

```

### ä½¿ç”¨markerè¿è¡Œ

```bash
# è‹±æ–‡ç‰ˆæµ‹è¯•
python -m pytest -m monoxer -v --language=en

# æ—¥æ–‡ç‰ˆæµ‹è¯•
python -m pytest -m monoxer -v --language=ja

```

## ğŸ“¸ æˆªå›¾ç®¡ç†å·¥å…·

### ä½¿ç”¨ç‹¬ç«‹è„šæœ¬

```bash
# æŸ¥çœ‹å¯ç”¨å‘½ä»¤
python scripts/manage_screenshots.py -a com.monoxer --list

# å¯¹æ¯”æˆªå›¾
python scripts/manage_screenshots.py -a com.monoxer --compare

# è®¾ç½®åŸºå‡†æˆªå›¾
python scripts/manage_screenshots.py -a com.monoxer --set-base

# æ¸…ç©ºåŸºå‡†æˆªå›¾
python scripts/manage_screenshots.py -a com.monoxer --clear-base

# æ¸…ç©ºå½“å‰æˆªå›¾
python scripts/manage_screenshots.py -a com.monoxer --clear-cur
```

## ğŸ”§ é…ç½®è¯´æ˜

### ç¯å¢ƒè¦æ±‚
- Python 3.12+
- Appium Server
- Androidæ¨¡æ‹Ÿå™¨
- ATFè™šæ‹Ÿç¯å¢ƒ (`pyenv activate atf`)

### æ¨¡æ‹Ÿå™¨é…ç½®
- **è‹±æ–‡**: `emulator-5554` (Android 13)
- **æ—¥æ–‡**: `emulator-5556` (Android 14)

### è¯­è¨€é…ç½®æ˜ å°„
```python
LANGUAGE_CONFIG_MAP = {
    "en": EnglishMonoxerTestData,
    "ja": JapaneseMonoxerTestData,    
}
```

## ğŸ—ï¸ æ¶æ„è®¾è®¡

### æµ‹è¯•æ•°æ®ç»„ç»‡
```python
# åŸºç±» - å…¬å…±å…ƒç´ å’Œé…ç½®
class BaseMonoxerTestData:
    class CommonLocators:  # ä¸ä¾èµ–è¯­è¨€çš„å®šä½å™¨
    class CommonTestData:  # ä¸ä¾èµ–è¯­è¨€çš„æµ‹è¯•æ•°æ®

# è¯­è¨€ç‰¹å®šç±» - ç»§æ‰¿åŸºç±»
class EnglishMonoxerTestData(BaseMonoxerTestData):
    class Locators(BaseMonoxerTestData.CommonLocators):  # è‹±æ–‡å®šä½å™¨
    class TestData(BaseMonoxerTestData.CommonTestData):  # è‹±æ–‡æµ‹è¯•æ•°æ®
    class AppiumConfig:  # è‹±æ–‡Appiumé…ç½®
```

### é¡µé¢å¯¹è±¡è®¾è®¡
```python
class MainPage(PageObject):
    def __init__(self, driver, test_data=None):
        self.test_data = test_data or MonoxerTestData  # æ”¯æŒå¤šè¯­è¨€
        # ä½¿ç”¨ self.test_data.Locators.XXX è·å–è¯­è¨€ç‰¹å®šå®šä½å™¨
```

## ğŸ¯ æœ€ä½³å®è·µ

1. **è¯­è¨€éš”ç¦»**: ä¸åŒè¯­è¨€çš„æµ‹è¯•æ•°æ®å®Œå…¨éš”ç¦»ï¼Œé¿å…å†²çª
2. **å…¬å…±å…ƒç´ å¤ç”¨**: ä¸ä¾èµ–è¯­è¨€çš„å…ƒç´ åœ¨åŸºç±»ä¸­å®šä¹‰
3. **é…ç½®ç»Ÿä¸€**: é€šè¿‡å‘½ä»¤è¡Œå‚æ•°ç»Ÿä¸€ç®¡ç†è¯­è¨€é…ç½®
4. **é”™è¯¯å¤„ç†**: é’ˆå¯¹ä¸åŒè¯­è¨€çš„é”™è¯¯ä¿¡æ¯è¿›è¡Œé€‚å½“å¤„ç†
5. **æˆªå›¾ç®¡ç†**: å¤šè¯­è¨€æµ‹è¯•çš„æˆªå›¾åˆ†åˆ«ç®¡ç†

## ğŸ› è°ƒè¯•æŠ€å·§

1. **è¯­è¨€åˆ‡æ¢**: ä½¿ç”¨ `--language` å‚æ•°åˆ‡æ¢æµ‹è¯•è¯­è¨€
2. **æˆªå›¾åˆ†æ**: æŸ¥çœ‹æˆªå›¾ç¡®è®¤UIå…ƒç´ æ˜¯å¦æ­£ç¡®è¯†åˆ«
3. **æ—¥å¿—åˆ†æ**: æŸ¥çœ‹è¯¦ç»†æ—¥å¿—äº†è§£æµ‹è¯•æ‰§è¡Œè¿‡ç¨‹
4. **å…ƒç´ å®šä½**: ä½¿ç”¨Appium InspectoréªŒè¯å…ƒç´ å®šä½å™¨

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **æ¨¡æ‹Ÿå™¨ç¯å¢ƒ**: ç¡®ä¿å¯¹åº”è¯­è¨€çš„æ¨¡æ‹Ÿå™¨å·²å¯åŠ¨å¹¶æ­£ç¡®é…ç½®
2. **åº”ç”¨è¯­è¨€**: ç¡®ä¿åº”ç”¨å·²å®‰è£…å¯¹åº”è¯­è¨€ç‰ˆæœ¬
3. **å®šä½å™¨æ›´æ–°**: å½“åº”ç”¨UIå˜åŒ–æ—¶ï¼Œéœ€è¦æ›´æ–°å¯¹åº”è¯­è¨€çš„å®šä½å™¨
4. **æµ‹è¯•æ•°æ®**: ä¸åŒè¯­è¨€çš„æµ‹è¯•æ•°æ®å¯èƒ½éœ€è¦è°ƒæ•´
5. **æˆªå›¾å¯¹æ¯”**: å¤šè¯­è¨€æµ‹è¯•çš„æˆªå›¾å¯¹æ¯”éœ€è¦è€ƒè™‘UIå·®å¼‚

## ğŸ“ æ‰©å±•æŒ‡å—

### æ·»åŠ æ–°è¯­è¨€æ”¯æŒ
1. åˆ›å»ºæ–°çš„è¯­è¨€æµ‹è¯•æ•°æ®ç±»
2. ç»§æ‰¿ `BaseMonoxerTestData`
3. å®ç°è¯­è¨€ç‰¹å®šçš„å®šä½å™¨å’Œé…ç½®
4. æ›´æ–° `LANGUAGE_CONFIG_MAP`
5. æµ‹è¯•æ–°è¯­è¨€åŠŸèƒ½

### æ·»åŠ æ–°åŠŸèƒ½æµ‹è¯•
1. åœ¨åŸºç±»ä¸­æ·»åŠ å…¬å…±å®šä½å™¨
2. åœ¨è¯­è¨€ç±»ä¸­æ·»åŠ è¯­è¨€ç‰¹å®šå®šä½å™¨
3. æ›´æ–°é¡µé¢å¯¹è±¡æ–¹æ³•
4. æ·»åŠ æµ‹è¯•ç”¨ä¾‹
5. éªŒè¯å¤šè¯­è¨€æ”¯æŒ
